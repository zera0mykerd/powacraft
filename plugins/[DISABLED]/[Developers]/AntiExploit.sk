#░█████╗░███╗░░██╗████████╗██╗███████╗██╗░░██╗██████╗░██╗░░░░░░█████╗░██╗████████╗
#██╔══██╗████╗░██║╚══██╔══╝██║██╔════╝╚██╗██╔╝██╔══██╗██║░░░░░██╔══██╗██║╚══██╔══╝
#███████║██╔██╗██║░░░██║░░░██║█████╗░░░╚███╔╝░██████╔╝██║░░░░░██║░░██║██║░░░██║░░░
#██╔══██║██║╚████║░░░██║░░░██║██╔══╝░░░██╔██╗░██╔═══╝░██║░░░░░██║░░██║██║░░░██║░░░
#██║░░██║██║░╚███║░░░██║░░░██║███████╗██╔╝╚██╗██║░░░░░███████╗╚█████╔╝██║░░░██║░░░
#╚═╝░░╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚═╝╚══════╝╚═╝░░╚═╝╚═╝░░░░░╚══════╝░╚════╝░╚═╝░░░╚═╝░░░
#Developer: kepg 
#Discord: Private#1619 DM 4 HELP
#Discord Protectors: https://discord.gg/csHq7nyTxm

options:
    p: You have no permission to execute this command! 
    antiexploit.join: &6[AntiExploit] &aPlease join again &7, &aafter 5 seconds.
    licence: https://pastebin.com/6N05NjFv
    antiexploit.bypass: antiexploit.bypass
#

on load:
 send "&6[AntiExploit&6] &aHas been enabled!" to console

#

command /ae [<text>]:
    usage: /ae
    aliases: /anticrash
    trigger:
        send "&6This server using &aAntiExploit Protection &8(&a1.0 Protection.&8)"
        send "&6AntiExploit Link: &aspigotmc.org/antiexploit-skript.103527"
        send "&6About AntiExploit: &aBlocking Multiveres , WorldEdit , Plugins"
        send "&6My creator is: &akepg"
        send "&6Discord link: &ahttps://discord.gg/csHq7nyTxm"

#

command /antiexploit reload [<text>]:
    usage: /antiexploit reload
    permission: antiexploit.admin
    permission message: {@p}
    trigger:
        make console execute command "skript reload AntiExploit"
        send "&6[AntiExploit] &aSuccesfully reloaded &6AntiExploit.sk"

#

command /security off [<text>]:
    usage: /security off
    permission: antiexploit.admin
    permission message: {@p}
    trigger:
        make console execute command "skript disable AntiExploit"
        send "&6[AntiExploit] &cSecurity now is offline!"

#

on command:
    if complete command contains ":":
        cancel event
        send "&6[AntiExploit] &cThis syntax is disabled!"
        wait 5 ticks
        make console execute command "kick %player% &cAntiExploit crash detected!"
        broadcast "&c%player% &atried to see plugins!"

#

on command:
    if complete command contains "for(i=0;i<256;i++)":
        cancel event
        send "&6[AntiExploit] &cThis command is disabled!"
        wait 5 ticks
        make console execute command "kick %player% &cAntiExploit crash detected!"
        broadcast "&c%player% &atried to crash server!"

#

on command:
    if complete command contains "^(.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.++)&^":
        cancel event
        send "&6[AntiExploit] &cThis command is disabled!"
        wait 5 ticks
        make console execute command "kick %player% &cAntiExploit crash detected!"
        broadcast "&c%player% &atried to crash server!"

#

on place lava:
 cancel event
 make console execute command "ban %player% &cAntiExploit added you to Blacklist."
 broadcast "&c%player% &atried to greifing server!"

#

on place tnt:
 cancel event
 make console execute command "ban %player% &cAntiExploit added you to Blacklist."
 broadcast "&c%player% &atried to greifing server!"

#

function kickOnCrash(p: player, r: text):
    if {antiCrasher::isKicked::%{_p}%} is not set:
        set {antiCrasher::isKicked::%{_p}%} to {_p}
        kick {_p} due to "%{_r}%"
        send "&ePlayer &b%{_p}% &eHas Been Kicked For Sending Harmful Packets To The Server!" to console
        wait 2 ticks # I added this to avoid console spam #
        delete {antiCrasher::isKicked::%{_p}%}

# 

on packet:
    if event-string is "PacketPlayInCustomPayload":
        set {_packet} to packet field "a"
        if "%{_packet}%" = "MC|BEdit" or "MC|PickItem" or "MC|TrSel" or "MC|BSign":
            cancel event
            if {antiCrasher::Warns::%player%} is not set:
                set {antiCrasher::Warns::%player%} to player
                send "&ePlayer &b%player% &eHas Been Blocked From Sending Harmful Packets To The Server!" to console
            wait 1 tick
            kickOnCrash(player, "ReadTimeoutException : null")

#

on quit:
    if {antiCrasher::Warns::%player%} is set:
        delete {antiCrasher::Warns::%player%}

#

on join:
    if {antiCrasher::Warns::%player%} is set:
        delete {antiCrasher::Warns::%player%}

#
	
on connect:
	{antiexploit.join} isn't true:
		kick player due to "{@antiexploit.join}"
		set {antiexploit.join} to true

#

on quit:
        set {antiexploit.join} to false

#

on load:
	set {antiexploit.join} to false

#

on connect:
	if player does not have the permission "{@antiexploit.bypass}":
		add 1 to {antiexploit.guard}
		if {antiexploit.guard} is 15:
			set {antiexploit.activated} to 1

#
			
on connect:
	if {antiexploit.activated} is 1:
		if player does not have the permission "{@antiexploit.bypass}":
			kick player due to "&cAntiExploit crash detected!"

#
		
every 20 seconds:
	set {antiexploit.guard} to 0
	set {antiexploit.activated} to 0

#

command /plugins [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /pl [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:pl [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /? [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:help [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /ver [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"
	
command /version [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:version [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:ver [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:about [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /about [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:? [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:ban [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:ipban [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:kick [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /plugin [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:plugins [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /help [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:? [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /me [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:me [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /tell [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:tell [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /say [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /minecraft:say [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /bukkit:timings [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

#

command //calc [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command //solve [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command //calculate [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command //desc [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /worldedit:/calc [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /worldedit:/solve [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"

command /worldedit:/eval [<text>]:
	trigger:
		send "&6[AntiExploit] &cThis command is disabled!"












